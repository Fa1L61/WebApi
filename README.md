# Работа с сервисом

## 1 Подключение к бд Postgress
Для изменения строки подключения перейдите в файл ```/context/ApplicationContext``` и измените параметр ```optionsBuilder.UseNpgsql([Ваша_строка_подключения])```

## 2 Тестирование

Для тестирования сервиса можно воспользоваться Postman, но я решил оставить Swagger для более удобного визуального использования

### 2.1 Добавление заявки

Для того, чтобы добавить заявку, необходимо выполнить запрос:
```bash
POST api/Applications
{
    authorId: "3fa85f64-5717-4562-b3fc-2c963f66afa6",
	activityType: 0,
	title: "C#",
	description: "Описание",
	plan: "План конференции"
}
```
Вернет: 
-если все впорядке - ```OK, 200```
-если что-то пошло не так - ```NoContent()```

### 2.2 Обновление заявки 
Для того, чтобы изменить заявку, необходимо выполнить запрос:
```bash
PUT /api/Applications/{id}
{
    "activityType": 1,
    "title": "string",
    "description": "string",
    "plan": "string"
}
```
Вернет: 
-если все впорядке - вернет обновленный объект и запишет его в бд
-если что-то пошло не так - ```NoContent()```

### 2.3 Удаление заявки 
Для того, чтобы удалить заявку, необходимо выполнить запрос:
```bash
DELETE /api/Applications/{id}
```
Вернет: 
-если все впорядке - удалит объект и вернет ```OK, 200```
-если данного объекта нет - ```NoContent()```

### 2.4 Отправка заявки на рассмотрение программным комитетом
Для того, чтобы отправить заявку, необходимо выполнить запрос:

```bash
POST api/applications/{id}/submit
```
Вернет: 
-если такая заявка есть - вернет ```OK, 200``` и изменит в бд данные о заявке
-если такой заявки нет - вернет ```NoContent()```

### 2.5 Получение списка заявок, поданных после указанной даты

Для того, чтобы получить список заявок, поданных после указанной даты, необходимо выполнить запрос:
```bash
applications?afterDate={Дата_UTC_Формата}&isSubmitted=true
```
Вернет: 
-если такие заявки есть - вернет список объектов
-если таких заявок нет - вернет пустой список

### 2.6 Получение заявок не поданных и старше определенной даты

Для того, чтобы получить список заявок, поданных после указанной даты, необходимо выполнить запрос:
```bash
applications?afterDate={Дата_UTC_Формата}&isSubmitted=false
```
Вернет: 
-если такие заявки есть - вернет список объектов
-если таких заявок нет - вернет пустой список

### 2.7 Получение текущей не поданной заявки для указанного пользователя

Для того, чтобы получить текущую не поданую заявку, необходимо выполнить запрос:
```bash
Get api/applications/{authorId}/current
```
Вернет: 
-если такая заявка есть - вернет эту заявку
-если такой заявки нет - вернет ```NotFound()```

### 2.8 Получение заявки по идентификатору

Для того, чтобы получить заявку по идентификатору, необходимо выполнить запрос:
```bash
Get api/applications/{id}
```
Вернет: 
-если такая заявка есть - вернет эту заявку
-если такой заявки нет - вернет ```NotFound()```

### 2.9 Получение списка активностей

Для того, чтобы получить текущую не поданую заявку, необходимо выполнить запрос:
```bash
Get api/applications/{id}
```
Вернет: 
-список всех видов активностей и их описание

## 3 Дополнение
- у пользователя может только одна не отправленная заявка (черновика заявки)
- нельзя создать заявку не указав идентификатор пользователя
- нельзя создать заявку не указав хотя бы еще одно поле помимо идентификатора пользователя
- нельзя отредактировать заявку так, чтобы  в ней не остались заполненными идентификатор пользователя + еще одно поле
- нельзя редактировать отправленные на рассмотрение заявки
- нельзя отменить / удалить заявки отправленные на рассмотрение
- нельзя удалить или редактировать не существующую заявку
- можно отправить на рассмотрение только заявки у которых заполнены все обязательные поля
- нельзя отправить на рассмотрение не существующую заявку
- запрос на получение поданных и не поданных заявок одновременно должен считаться не корректным